#include <stdint.h>
#include <stdbool.h>

#include "GUID.h"

typedef struct gpt_header_s {
  char     signature[8];
  uint32_t revision;
  uint32_t header_size;
  uint32_t header_crc;
  uint32_t reserved1;
  uint64_t current_lba;
  uint64_t backup_lba;
  uint64_t first_useable_lba;
  uint64_t last_useable_lba;
  uint8_t  disc_guid[16];
  uint64_t entries_start_lba;
  uint32_t entry_count;
  uint32_t entry_size;
  uint32_t entries_crc;
  uint8_t  reserved2[]; // The rest of the block should be zeroes.
} gpt_header_t;

typedef struct gpt_entry_s {
  guid_t   type_guid;
  guid_t   part_guid;
  uint64_t first_lba;
  uint64_t last_lba;
  uint64_t flags;
  uint16_t name[36];
} gpt_entry_t;

// Returns the header if the data points to a valid header, else 0
gpt_header_t *get_header(void *data, int size);




